 1. 프로젝트 개요
1.1 서비스 설명
병원 동행 및 돌봄 서비스가 필요한 고객과 서비스를 제공하는 매니저를 연결하는 양방향 매칭 플랫폼입니다.
1.2 비즈니스 모델

고객이 서비스 요청 작성
매니저들이 푸시 알림을 받고 지원
고객이 여러 지원자 중 매니저 선택
서비스 제공 후 자동 결제
플랫폼은 수수료 수익 (매니저 수익의 20%)

1.3 타겟 규모

초기 목표: 500명 (고객 300명, 매니저 200명)
월 매칭 건수: 300-600건
일 동시 접속자: 20-50명

1.4 핵심 차별점

매니저 자격증 불필요 (진입장벽 낮춤)
푸시 알림 기반 실시간 매칭
카드 등록 후 자동 결제 (편리성)
시간당 차등 요금제


🛠️ 2. 기술 스택 선정 이유
2.1 프론트엔드
html,php,tailwind



Styling: Tailwind CSS
- 이유: 빠른 개발, 일관된 디자인, 모바일 최적화

UI Components: shadcn/ui
- 이유: 복사 가능한 컴포넌트, 커스터마이징 용이



2.2 백엔드
mariaDB, mysql



2.3 결제 및 알림
Payment: 토스페이먼츠
- 빌링키 발급 (카드 등록)
- 자동 결제
- 정산 API

Push Notification: Firebase Cloud Messaging (FCM)
- 웹 푸시
- 앱 푸시 (향후)

SMS: 알리고 또는 CoolSMS
- 인증번호
- 중요 알림

Email: SendGrid
- 무료 티어: 100통/일
- 회원가입 인증, 영수증 발송



3. 데이터베이스 설계
3.1 전체 구조 개념

핵심 엔티티:
1. users - 모든 사용자 (고객, 매니저, 관리자)
2. manager_profiles - 매니저 추가 정보
3. service_requests - 서비스 요청
4. applications - 매니저 지원
5. bookings - 확정된 예약
6. reviews - 리뷰
7. notifications - 알림
8. billing_keys - 결제 카드 정보 (빌링키)
9. payments - 결제 내역
10. settlements - 매니저 정산

3.2 테이블별 상세 설계
TABLE: users (회원

목적: 모든 사용자의 기본 정보 저장

컬럼:
- id: UUID, Primary Key, 자동생성
- email: 문자열, 고유값, NOT NULL (로그인 ID)
- password_hash: 문자열, NOT NULL (bcrypt 암호화)
- name: 문자열, NOT NULL (실명)
- phone: 문자열, NULL 허용 (010-1234-5678 형식)
- 주소1
- 상세주소소
- role: ENUM, NOT NULL (CUSTOMER, MANAGER, ADMIN 중 하나)
- is_verified: 불리언, 기본값 false (이메일 인증 여부)
- is_active: 불리언, 기본값 true (계정 활성화 상태)
- profile_image_url: 문자열, NULL 허용 (Supabase Storage URL)
- created_at: 타임스탬프, 자동생성
- updated_at: 타임스탬프, 자동업데이트
- last_login_at: 타임스탬프, NULL 허용

인덱스:

- phone - 로그인 ID로 사용용
- role - 역할별 필터링
- email (UNIQUE) - 참조조

비즈니스 규칙:
- 이메일은 중복 불가
- 전화번호는 필수수
- role은 회원가입 시 선택하며 변경 불가
- 탈퇴 시 is_active를 false로 변경 (데이터 보존)

TABLE: manager_profiles (매니저 프로필)

목적: 매니저 역할 사용자의 추가 정보

컬럼:
- id: UUID, Primary Key
- user_id: UUID, Foreign Key → users.id, UNIQUE, NOT NULL
- bio: 텍스트, NULL 허용 (자기소개, 최대 1000자)
- service_areas: 문자열 배열, NOT NULL (예: ['서울 강남구', '서울 서초구'])
- available_services: 문자열 배열, NOT NULL (예: ['병원동행', '노인돌봄'])
- hourly_rate: 정수, NULL 허용 (희망 시간당 요금, 원 단위)
- rating: 소수점(3,2), 기본값 0.00 (평균 평점, 0.00 ~ 5.00)
- review_count: 정수, 기본값 0 (총 리뷰 수)
- total_bookings: 정수, 기본값 0 (총 완료 서비스 수)
- is_active: 불리언, 기본값 true (활동 상태 ON/OFF)
- lat: 소수점(10,8), NULL 허용 (활동 중심 위도)
- lng: 소수점(11,8), NULL 허용 (활동 중심 경도)
- created_at: 타임스탬프
- updated_at: 타임스탬프

인덱스:
- user_id (UNIQUE)
- is_active
- (lat, lng) - 지리 검색용 복합 인덱스

비즈니스 규칙:
- user_id는 role='MANAGER'인 users만 가능
- service_areas는 최소 1개 이상 필수
- available_services는 최소 1개 이상 필수
- 매니저가 is_active=false로 설정하면 새 요청 알림 안 받음
- rating과 review_count는 리뷰 작성 시 자동 업데이트

TABLE: service_requests (서비스 요청)

목적: 고객의 서비스 요청 저장

컬럼:
- id: UUID, Primary Key
- customer_id: UUID, Foreign Key → users.id, NOT NULL
- service_type: 문자열, NOT NULL (예: '병원동행', '노인돌봄', '아이돌봄')
- service_date: 날짜, NOT NULL (서비스 제공 날짜)
- start_time: 시간, NOT NULL (서비스 시작 시간, HH:MM 형식)
- duration_minutes: 정수, NOT NULL (예상 소요 시간, 분 단위)
- address: 문자열, NOT NULL (기본 주소)
- address_detail: 문자열, NULL 허용 (상세 주소, 동/호수 등)
- lat: 소수점(10,8), NOT NULL (위도)
- lng: 소수점(11,8), NOT NULL (경도)
- details: 텍스트, NULL 허용 (상세 요청사항)
- status: ENUM, NOT NULL (PENDING, MATCHING, CONFIRMED, COMPLETED, CANCELLED)
- estimated_price: 정수, NOT NULL (예상 금액, 원 단위)
- created_at: 타임스탬프
- updated_at: 타임스탬프

상태 전이:
PENDING → MATCHING → CONFIRMED → COMPLETED
         ↓                         ↓
    CANCELLED                  CANCELLED

인덱스:
- customer_id
- status
- service_date
- (lat, lng)

비즈니스 규칙:
- customer_id는 role='CUSTOMER'인 users만 가능
- service_date는 현재 날짜 이후만 가능
- estimated_price는 (duration_minutes / 60) × 시간당 기본요금으로 자동 계산
- status가 PENDING일 때만 취소 가능
- MATCHING 상태: 최소 1명 이상 지원자 있음
- CONFIRMED 상태: 매니저 선택 완료

TABLE: applications (매니저 지원)
목적: 매니저가 서비스 요청에 지원한 내역

컬럼:
- id: UUID, Primary Key
- request_id: UUID, Foreign Key → service_requests.id, NOT NULL
- manager_id: UUID, Foreign Key → users.id, NOT NULL
- status: ENUM, NOT NULL (PENDING, ACCEPTED, REJECTED)
- message: 텍스트, NULL 허용 (지원 메시지, 최대 500자)
- created_at: 타임스탬프

제약조건:
- UNIQUE(request_id, manager_id) - 동일 요청에 중복 지원 방지

인덱스:
- request_id
- manager_id
- status

비즈니스 규칙:
- manager_id는 role='MANAGER'이고 manager_profiles.is_active=true인 사용자만
- 한 요청에 같은 매니저는 1번만 지원 가능
- 고객이 매니저를 선택하면:
  * 선택된 application: status → ACCEPTED
  * 다른 applications: status → REJECTED
- status가 PENDING일 때만 취소 가능

TABLE: bookings (확정된 예약)
목적: 고객이 매니저를 선택하여 확정된 예약

컬럼:
- id: UUID, Primary Key
- request_id: UUID, Foreign Key → service_requests.id, UNIQUE, NOT NULL
- manager_id: UUID, Foreign Key → users.id, NOT NULL
- actual_start_time: 타임스탬프, NULL 허용 (실제 시작 시간)
- actual_end_time: 타임스탬프, NULL 허용 (실제 종료 시간)
- final_price: 정수, NOT NULL (최종 결제 금액, 원 단위)
- payment_status: ENUM, NOT NULL (PENDING, PAID, REFUNDED)
- created_at: 타임스탬프
- updated_at: 타임스탬프

인덱스:
- request_id (UNIQUE)
- manager_id
- payment_status

비즈니스 규칙:
- request_id는 1:1 관계 (한 요청당 하나의 예약만)
- 생성 시점: 고객이 매니저 선택 완료 시
- actual_start_time: 매니저가 "서비스 시작" 버튼 클릭 시 기록
- actual_end_time: 매니저가 "서비스 완료" 버튼 클릭 시 기록
- final_price 계산 공식:
  * 기본 금액 = (actual_end_time - actual_start_time) × 시간당 요금
 
- payment_status 전이:
  * 서비스 완료 후: PENDING
  * 24시간 후 자동 결제: PENDING → PAID
  * 환불 시: PAID → REFUNDED

  TABLE: reviews (리뷰)
  목적: 서비스 완료 후 고객의 매니저 평가

컬럼:
- id: UUID, Primary Key
- booking_id: UUID, Foreign Key → bookings.id, UNIQUE, NOT NULL
- reviewer_id: UUID, Foreign Key → users.id, NOT NULL (리뷰 작성자, 고객)
- manager_id: UUID, Foreign Key → users.id, NOT NULL (리뷰 대상, 매니저)
- rating: 정수, NOT NULL (1 ~ 5)
- comment: 텍스트, NULL 허용 (리뷰 내용, 최대 1000자)
- created_at: 타임스탬프

인덱스:
- booking_id (UNIQUE)
- manager_id
- rating

비즈니스 규칙:
- booking_id는 1:1 관계 (한 예약당 하나의 리뷰만)
- 작성 가능 시점: bookings.payment_status = 'PAID' 이후
- reviewer_id는 booking의 customer_id와 동일해야 함
- rating은 1~5 사이 정수만 가능
- 리뷰 작성 후 트리거:
  1. manager_profiles.rating 재계산 (평균)
  2. manager_profiles.review_count += 1
  3. 매니저에게 알림 발송
- 수정/삭제 불가 (작성 후 변경 금지)

TABLE: notifications (알림)
목적: 사용자에게 보낼 알림 저장

컬럼:
- id: UUID, Primary Key
- user_id: UUID, Foreign Key → users.id, NOT NULL
- type: 문자열, NOT NULL (알림 유형 코드)
- title: 문자열, NOT NULL (알림 제목, 최대 100자)
- message: 텍스트, NOT NULL (알림 내용)
- data: JSONB, NULL 허용 (추가 데이터, 예: {request_id: 'xxx'})
- is_read: 불리언, 기본값 false (읽음 여부)
- created_at: 타임스탬프

알림 유형 (type):
고객:
- NEW_APPLICATION: 새로운 매니저가 지원했습니다
- BOOKING_CONFIRMED: 예약이 확정되었습니다
- SERVICE_STARTING_SOON: 서비스 시작 1시간 전입니다
- SERVICE_COMPLETED: 서비스가 완료되었습니다
- PAYMENT_COMPLETED: 결제가 완료되었습니다
- DISPUTE_RESOLVED: 이의신청이 처리되었습니다

매니저:
- NEW_REQUEST_NEARBY: 근처에 새로운 요청이 있습니다
- APPLICATION_ACCEPTED: 지원이 수락되었습니다!
- APPLICATION_REJECTED: 다른 매니저가 선택되었습니다
- SERVICE_STARTING_SOON: 서비스 시작 1시간 전입니다
- NEW_REVIEW: 새로운 리뷰가 등록되었습니다
- SETTLEMENT_COMPLETED: 정산이 완료되었습니다

인덱스:
- user_id
- is_read
- created_at (DESC)

비즈니스 규칙:
- 알림 생성 시 동시에 FCM 푸시 발송
- 30일 지난 읽은 알림은 자동 삭제 (스케줄러)
- data 필드에는 화면 이동에 필요한 ID 저장

TABLE: billing_keys (결제 카드 정보)
목적: 고객의 등록된 결제 카드 빌링키 저장

컬럼:
- id: UUID, Primary Key
- user_id: UUID, Foreign Key → users.id, UNIQUE, NOT NULL
- billing_key: 문자열, NOT NULL (토스페이먼츠 빌링키, 암호화)
- card_company: 문자열, NOT NULL (카드사명, 예: '신한카드')
- card_number_last4: 문자열, NOT NULL (카드 끝 4자리, 예: '1234')
- is_active: 불리언, 기본값 true (사용 가능 여부)
- created_at: 타임스탬프
- updated_at: 타임스탬프

인덱스:
- user_id (UNIQUE)

비즈니스 규칙:
- user_id는 role='CUSTOMER'인 users만 가능
- 한 고객당 하나의 카드만 등록 가능
- billing_key는 AES-256으로 암호화 저장
- 실제 카드번호는 저장하지 않음 (PCI-DSS 준수)
- 카드 변경 시 기존 데이터 is_active=false로 변경 후 새로 생성
- 빌링키 만료 또는 오류 시 is_active=false

TABLE: payments (결제 내역)
목적: 모든 결제 거래 기록

컬럼:
- id: UUID, Primary Key
- booking_id: UUID, Foreign Key → bookings.id, NOT NULL
- customer_id: UUID, Foreign Key → users.id, NOT NULL
- amount: 정수, NOT NULL (결제 금액, 원 단위)
- payment_method: 문자열, NOT NULL (예: 'CARD')
- payment_key: 문자열, NULL 허용 (토스페이먼츠 결제 키)
- status: ENUM, NOT NULL (PENDING, SUCCESS, FAILED, CANCELLED, REFUNDED)
- failed_reason: 텍스트, NULL 허용 (실패 사유)
- refund_amount: 정수, NULL 허용 (환불 금액)
- refund_reason: 텍스트, NULL 허용 (환불 사유)
- paid_at: 타임스탬프, NULL 허용 (결제 완료 시각)
- created_at: 타임스탬프

인덱스:
- booking_id
- customer_id
- status
- paid_at

비즈니스 규칙:
- 생성 시점: 서비스 완료 24시간 후 (자동)
- status 전이:
  * 결제 시도: PENDING
  * 성공: PENDING → SUCCESS
  * 실패: PENDING → FAILED (재시도 3회)
  * 취소: SUCCESS → CANCELLED
  * 환불: SUCCESS → REFUNDED
- 결제 성공 시:
  1. bookings.payment_status → 'PAID'
  2. 고객에게 영수증 이메일 발송
  3. 매니저에게 정산 대기 알림
- 결제 실패 시:
  1. 고객에게 알림 발송
  2. 3회 재시도 후에도 실패 시 관리자 알림

  TABLE: settlements (매니저 정산)
  목적: 매니저에게 지급할 정산 내역

컬럼:
- id: UUID, Primary Key
- manager_id: UUID, Foreign Key → users.id, NOT NULL
- booking_id: UUID, Foreign Key → bookings.id, NOT NULL
- gross_amount: 정수, NOT NULL (총 결제 금액)
- platform_fee: 정수, NOT NULL (플랫폼 수수료)
- platform_fee_rate: 소수점, NOT NULL (수수료율, 예: 0.20)
- net_amount: 정수, NOT NULL (매니저 실수령액)
- status: ENUM, NOT NULL (PENDING, COMPLETED, CANCELLED)
- bank_name: 문자열, NULL 허용 (은행명)
- account_number: 문자열, NULL 허용 (계좌번호, 암호화)
- account_holder: 문자열, NULL 허용 (예금주)
- settled_at: 타임스탬프, NULL 허용 (정산 완료 시각)
- created_at: 타임스탬프

인덱스:
- manager_id
- status
- created_at

비즈니스 규칙:
- 생성 시점: payments.status = 'SUCCESS' 이후
- 정산 금액 계산:
  * gross_amount = bookings.final_price
  * platform_fee = gross_amount × 0.20 (20% 수수료)
  * net_amount = gross_amount - platform_fee
- 정산 주기: 매주 월요일 (PENDING 상태 일괄 처리)
- 정산 방법: 수동 계좌 이체 (초기에는 자동화 없음)
- 정산 완료 시:
  1. status → COMPLETED
  2. settled_at 기록
  3. 매니저에게 알림 발송
- 최소 정산 금액: 10,000원 (미달 시 다음 주로 이월)

3.3 관계도 요약
users (1) ─── (1) manager_profiles
  │
  ├─── (1:N) service_requests
  │             │
  │             ├─── (1:N) applications
  │             │
  │             └─── (1:1) bookings
  │                         │
  │                         ├─── (1:1) reviews
  │                         │
  │                         ├─── (1:N) payments
  │                         │
  │                         └─── (1:1) settlements
  │
  ├─── (1:N) notifications
  │
  └─── (1:1) billing_keys

  4. 화면 설계 및 사용자 플로우
4.1 공통 레이아웃
헤더 (모든 페이지 공통)
구성요소:
1. 로고 (좌측)
   - 클릭 시 홈으로 이동
   - 텍스트: "행복안심동행" 또는 이미지 로고

2. 네비게이션 메뉴 (중앙)
   로그아웃 상태:
   - (없음)
   
   고객 로그인:
   - "서비스 요청"
   - "내 예약"
   
   매니저 로그인:
   - "새 요청"
   - "내 일정"
   
3. 우측 메뉴
   로그아웃 상태:
   - "로그인" 버튼
   - "회원가입" 버튼
   
   로그인 상태:
   - 알림 아이콘 (🔔) + 뱃지 (읽지 않은 알림 수)
   - 프로필 이미지 (클릭 시 드롭다운)
     * "프로필"
     * "결제 수단" (고객만)
     * "수익 관리" (매니저만)
     * "로그아웃"

모바일:
- 햄버거 메뉴 (☰)
- 클릭 시 사이드바 슬라이드

알림 드롭다운
위치: 헤더 알림 아이콘 클릭 시

구성:
- 제목: "알림" + "모두 읽음" 버튼
- 알림 목록 (최대 10개, 스크롤)
  각 알림:
  * 아이콘 (알림 유형별)
  * 제목 (굵게)
  * 내용
  * 시간 (예: "5분 전", "3시간 전")
  * 읽지 않은 알림: 배경색 다름
  * 클릭 시 해당 페이지로 이동 + 읽음 처리

- 하단: "모든 알림 보기" 링크

비어있을 때:
- "새로운 알림이 없습니다" 메시지

4.2 인증 관련 화면
회원가입 페이지
URL: /auth/signup

레이아웃:
- 좌측 (데스크톱): 일러스트 또는 서비스 소개 이미지
- 우측: 회원가입 폼

폼 구성:
1. 역할 선택 (필수, 라디오 버튼)
   ○ 고객으로 가입
   ○ 매니저로 가입
   
2. 이메일 (필수)
   - 플레이스홀더: "example@email.com"
   - 검증: 이메일 형식, 중복 확인
   
3. 비밀번호 (필수)
   - 플레이스홀더: "8자 이상 입력해주세요"
   - 검증: 최소 8자
   - 강도 표시: 약함/보통/강함
   
4. 비밀번호 확인 (필수)
   - 검증: 위와 동일한지 확인
   
5. 이름 (필수)
   - 플레이스홀더: "실명을 입력해주세요"
   
6. 전화번호 (선택)
   - 플레이스홀더: "010-1234-5678"
   - 자동 하이픈 입력
   
7. 약관 동의 (필수, 체크박스)
   ☐ 서비스 이용약관 동의 (필수) - "보기" 링크
   ☐ 개인정보 처리방침 동의 (필수) - "보기" 링크
   ☐ 마케팅 정보 수신 동의 (선택)

8. "회원가입" 버튼 (primary, 전체 너비)

하단 링크:
- "이미 계정이 있으신가요? 로그인"

소셜 로그인 (선택적):
- "또는 다음으로 가입" 구분선
- 카카오 로그인 버튼 (노란색)
- 네이버 로그인 버튼 (초록색)

에러 처리:
- 각 필드별 실시간 검증
- 에러 메시지는 필드 하단에 빨간색으로 표시
- 서버 에러: 폼 상단에 알림 박스

성공 시:
- 고객: /payment/register-card로 리다이렉트 (카드 등록)
- 매니저: /manager/profile로 리다이렉트 (프로필 작성)

로그인 페이지
URL: /auth/login

레이아웃: 회원가입과 동일

폼 구성:
1. 이메일
2. 비밀번호
   - "비밀번호를 잊으셨나요?" 링크
3. "로그인" 버튼
4. "회원가입" 링크

소셜 로그인:
- 카카오 로그인
- 네이버 로그인

성공 시:
- 이전 페이지로 리다이렉트 또는
- 고객: / (홈)
- 매니저: /manager/requests

4.3 고객 화면
홈페이지
URL: /

섹션 1: Hero
- 배경: 그라데이션 또는 이미지
- 헤드라인: "믿을 수 있는 병원동행과 돌봄 서비스"
- 서브 헤드라인: "필요한 순간, 신뢰할 수 있는 매니저와 함께"
- CTA 버튼: "지금 서비스 요청하기" (대형, primary)
  * 로그아웃: /auth/signup으로 이동
  * 로그인: /requests/new로 이동

섹션 2: 서비스 카테고리
- 제목: "어떤 도움이 필요하신가요?"
- 6개 카드 (2행 3열, 모바일 1열)
  각 카드:
  * 아이콘
  * 서비스명 (예: "병원 동행")
  * 간단한 설명
  * 클릭 시 /requests/new?type=병원동행

카테고리:
1. 병원 동행
2. 노인 돌봄
3. 아이 돌봄
4. 가사 돌봄
5. 생활활 동행
6. 일상 동행

섹션 3: 이용 방법
- 제목: "이렇게 간단합니다"
- 3단계 (1행 3열, 모바일 세로)
  
  Step 1: 서비스 요청
  - 아이콘: 📝
  - 설명: "원하는 서비스와 일시를 선택하세요"
  
  Step 2: 매니저 선택
  - 아이콘: 👥
  - 설명: "여러 매니저 중 원하는 분을 선택하세요"
  
  Step 3: 서비스 받기
  - 아이콘: ✨
  - 설명: "안심하고 서비스를 받으세요"

섹션 4: 리뷰
- 제목: "실제 이용 후기"
- 3-5개 리뷰 카드 슬라이더
  각 카드:
  * 별점 (⭐⭐⭐⭐⭐)
  * 리뷰 내용 (2-3줄)
  * 작성자 이니셜 (예: "김**)
  * 서비스 타입
  * 날짜

섹션 5: CTA
- 배경색 구분
- 헤드라인: "지금 바로 시작하세요"
- 버튼: "서비스 요청하기"

섹션 6: FAQ (선택적)
- 자주 묻는 질문 5-10개
- 아코디언 형태

푸터:
- 회사 정보
- 이용약관
- 개인정보처리방침
- 고객센터
- SNS 링크

서비스 요청 생성 (다단계 폼)
URL: /requests/new

전체 레이아웃:
- 상단: 진행 바 (1/5, 2/5, 3/5, 4/5, 5/5)
- 중앙: 현재 단계 폼
- 하단: "이전" + "다음" 버튼

─────────────────────────────────
Step 1: 서비스 선택
─────────────────────────────────

제목: "어떤 서비스가 필요하신가요?"

라디오 버튼 그룹 (카드 형태):
○ 병원 동행
  "진료 예약부터 귀가까지 함께합니다"

○ 1시간 전용 동행
  "짧은 용무에 적합합니다"

○ 투석 전용 동행
  "투석 전문 케어"

○ 노인 돌봄
  "어르신의 일상을 도와드립니다"

○ 아이 돌봄
  "안전하게 아이를 돌봐드립니다"

○ 기타
  "기타 동행 및 돌봄 서비스"

검증:
- 필수 선택

─────────────────────────────────
Step 2: 일시 선택
─────────────────────────────────

제목: "언제 서비스가 필요하신가요?"

1. 날짜 선택
   - 달력 UI (date picker)
   - 오늘 이후만 선택 가능
   - 오늘 날짜 하이라이트

2. 시작 시간
   - 드롭다운 (00:00 ~ 23:30, 30분 단위)
   - 인기 시간: 09:00, 10:00, 14:00 등 뱃지 표시

3. 예상 소요 시간
   - 버튼 그룹 (1시간, 2시간, 3시간, 4시간, 5시간 이상)
   - "5시간 이상" 선택 시 입력 필드 표시

예상 금액 미리보기 (우측 또는 하단):
- "예상 금액: 40,000원"
- 상세 내역:
  * 기본 요금: 20,000원/시간 × 2시간 = 40,000원
  * (야간 할증이 있으면 표시)
- 작은 글씨: "최종 금액은 실제 소요 시간에 따라 달라질 수 있습니다"

검증:
- 모두 필수
- 날짜는 오늘 이후
- 시간은 현재 시각 이후 (오늘 선택 시)

─────────────────────────────────
Step 3: 위치 입력
─────────────────────────────────

제목: "어디로 방문해 드릴까요?"

1. 주소 검색
   - 입력 필드 + "주소 검색" 버튼
   - 클릭 시 Kakao 주소 검색 팝업
   - 선택한 주소 자동 입력

2. 지도 표시
   - 선택한 주소를 지도에 마커로 표시
   - 지도 드래그로 미세 조정 가능
   - 중앙 고정 마커 + "이 위치로 설정" 버튼

3. 상세 주소 (선택)
   - 플레이스홀더: "동/호수를 입력해주세요 (선택)"

검증:
- 주소 필수
- 지도에서 좌표 확인

─────────────────────────────────
Step 4: 상세 요청사항
─────────────────────────────────

제목: "추가로 알려주실 사항이 있나요?"

1. 상세 요청사항 (선택)
   - 텍스트 에리어 (최대 1000자)
   - 플레이스홀더:
     "예: 
     - 병원 진료과: 내과
     - 휠체어 필요
     - 주차 가능 여부
     - 기타 요청사항"
   - 글자 수 카운터: "0/1000"

2. 유의사항 안내 (박스)
   "매니저에게 도움이 되는 정보를 자세히 적어주세요.
   예: 환자 상태, 준비물, 특별한 요청사항 등"

─────────────────────────────────
Step 5: 최종 확인
─────────────────────────────────

제목: "요청 내용을 확인해주세요"

요약 카드:
┌─────────────────────────────────┐
│ 서비스: 병원 동행                │
│ 일시: 2024년 2월 1일 10:00      │
│ 예상 시간: 2시간                │
│ 위치: 서울시 강남구 ...         │
│ 상세: (입력한 내용)             │
│                                 │
│ 예상 금액: 40,000원             │
│ (최종 금액은 실제 소요 시간에   │
│  따라 달라질 수 있습니다)       │
└─────────────────────────────────┘

"수정" 버튼 (각 항목별)

하단:
- 체크박스: "위 내용을 확인했으며 서비스 이용약관에 동의합니다"
- "요청하기" 버튼 (primary, 대형)

클릭 시:
1. API 호출 (POST /api/requests)
2. 로딩 인디케이터
3. 성공 시: 
   - "요청이 완료되었습니다!" 토스트
   - /requests/[id]로 리다이렉트
4. 실패 시:
   - 에러 메시지 표시
   - "다시 시도" 버튼

   요청 상세 및 지원자 확인
   URL: /requests/[id]

상태별 화면:

─────────────────────────────────
상태: PENDING (지원자 없음)
─────────────────────────────────

레이아웃:
1. 요청 정보 카드 (상단)
   - 서비스 타입 (뱃지)
   - 일시
   - 위치 (지도 미리보기)
   - 상세 내용
   - 예상 금액

2. 대기 상태 표시
   - 아이콘: ⏳ 또는 애니메이션
   - 텍스트: "매니저들에게 알림을 보냈습니다"
   - 서브텍스트: "곧 지원자가 나타날 거예요!"

3. 취소 버튼
   - 하단 고정
   - "요청 취소하기" (secondary, 회색)
   - 클릭 시 확인 모달
     * "정말 취소하시겠습니까?"
     * "취소" + "확인" 버튼

─────────────────────────────────
상태: MATCHING (지원자 있음)
─────────────────────────────────

레이아웃:
1. 요청 정보 카드 (접을 수 있음)

2. 지원자 목록
   - 제목: "N명의 매니저가 지원했습니다"
   
   각 지원자 카드:
   ┌─────────────────────────────────┐
   │ [사진] 김*나 님                  │
   │        ⭐ 4.8 (리뷰 23개)       │
   │                                 │
   │ "성실하게 모시겠습니다!"         │
   │                                 │
   │ 총 서비스: 45회                 │
   │ 활동 지역: 서울 강남구, 서초구   │
   │                                 │
   │ [프로필 보기] [선택하기]         │
   └─────────────────────────────────┘
   
   정렬 옵션:
   - 평점 높은 순 (기본)
   - 서비스 많은 순
   - 최근 지원 순

3. "프로필 보기" 클릭 시 모달
   ┌─────────────────────────────────┐
   │           매니저 프로필          │
   ├─────────────────────────────────┤
   │ [큰 사진]                       │
   │                                 │
   │ 김*나 님                        │
   │ ⭐ 4.8 (리뷰 23개)              │
   │                                 │
   │ 자기소개:                       │
   │ "10년차 간호조무사 출신으로...│
   │                                 │
   │ 제공 가능 서비스:               │
   │ • 병원 동행                     │
   │ • 노인 돌봄                     │
   │                                 │
   │ 활동 지역:                      │
   │ • 서울 강남구                   │
   │ • 서울 서초구                   │
   │                                 │
   │ 최근 리뷰:                      │
   │ ─────────────────────────────│
   │ ⭐⭐⭐⭐⭐                    │
   │ "정말 친절하시고..."            │
   │ - 박** (2024.01.25)            │
   │ ─────────────────────────────│
   │ (더 보기...)                    │
   │                                 │
   │ [이 매니저 선택하기] [닫기]     │
   └─────────────────────────────────┘

4. "선택하기" 클릭 시 확인 모달
   "김*나 님을 선택하시겠습니까?
   
   예상 금액: 40,000원
   (실제 소요 시간에 따라 달라질 수 있습니다)
   
   선택 후에는 변경할 수 없습니다.
   
   [취소] [선택 확정]"

5. 확정 후:
   - "선택이 완료되었습니다!" 토스트
   - 상태 변경: MATCHING → CONFIRMED
   - 매니저에게 알림 발송
   - 페이지 자동 새로고침

─────────────────────────────────
상태: CONFIRMED (매니저 선택 완료)
─────────────────────────────────

레이아웃:
1. 확정 안내 배너 (상단, 초록색 배경)
   "✓ 예약이 확정되었습니다!"

2. 선택된 매니저 정보
   ┌─────────────────────────────────┐
   │ [사진] 김*나 님                  │
   │        ⭐ 4.8 (리뷰 23개)       │
   │                                 │
   │ 연락처: 010-****-1234 (보기)    │
   │                                 │
   │ [메시지 보내기]                 │
   │ [전화하기]                      │
   └─────────────────────────────────┘

3. 서비스 정보
   - 일시: 2024년 2월 1일 10:00
   - 위치: (지도 + 주소)
   - 예상 금액: 40,000원

4. 안내 사항 (박스)
   "서비스 당일:
   - 시작 1시간 전 알림을 보내드립니다
   - 매니저가 '서비스 시작' 버튼을 누르면 실제 시간 기록이 시작됩니다
   - 서비스 완료 후 24시간 뒤 자동으로 결제됩니다"

5. 취소 정책 (작은 글씨)
   "24시간 전까지: 무료 취소
   24시간 이내: 취소 수수료 50%
   당일 취소: 전액 부과"

6. 하단 버튼
   - "취소 요청하기" (secondary)

   내 예약 목록
   URL: /bookings

상단 탭:
- [예정된 예약] (기본 선택)
- [완료된 예약]
- [취소된 예약]

각 탭 내용:

─────────────────────────────────
탭 1: 예정된 예약
─────────────────────────────────

정렬: 날짜 빠른 순

예약 카드:
┌─────────────────────────────────┐
│ 병원 동행                        │
│ 2024년 2월 1일 10:00 · 2시간    │
│                                 │
│ [사진] 김*나 님                  │
│        ⭐ 4.8                   │
│                                 │
│ 서울시 강남구 ...               │
│                                 │
│ 예상 금액: 40,000원             │
│                                 │
│ [상세보기] [매니저에게 연락]     │
└─────────────────────────────────┘

당일 예약 (특별 표시):
- 상단에 배치
- "오늘" 뱃지
- 시작 임박 시: "1시간 후 시작" 등 표시

빈 상태:
- 일러스트
- "예정된 예약이 없습니다"
- "서비스 요청하기" 버튼

─────────────────────────────────
탭 2: 완료된 예약
─────────────────────────────────

정렬: 최신 순

예약 카드:
┌─────────────────────────────────┐
│ ✓ 완료됨                         │
│                                 │
│ 병원 동행                        │
│ 2024년 1월 25일 10:00           │
│ 실제 소요: 2시간 15분           │
│                                 │
│ [사진] 김*나 님                  │
│        ⭐ 4.8                   │
│                                 │
│ 결제 금액: 45,000원             │
│ [영수증 보기]                   │
│                                 │
│ [리뷰 작성하기] (미작성 시)      │
│ 또는                            │
│ ⭐⭐⭐⭐⭐ (작성 완료 시)     │
│ "정말 친절하셨어요..."           │
│ [리뷰 보기]                     │
└─────────────────────────────────┘

리뷰 미작성 시:
- "리뷰 작성하기" 버튼 강조 (primary)
- 클릭 시 /bookings/[id]/review로 이동

리뷰 작성 완료 시:
- 별점 + 내용 미리보기
- 클릭 시 전체 리뷰 모달

─────────────────────────────────
탭 3: 취소된 예약
─────────────────────────────────

예약 카드:
┌─────────────────────────────────┐
│ ✗ 취소됨                         │
│                                 │
│ 병원 동행                        │
│ 2024년 1월 20일 10:00           │
│                                 │
│ 취소 사유: 고객 요청            │
│ 취소 일시: 2024.01.19 15:30    │
│                                 │
│ 환불 금액: 0원                  │
│ (취소 수수료 없음)              │
└─────────────────────────────────┘

필터 (모든 탭 공통):
- 전체
- 병원 동행
- 노인 돌봄
- 아이 돌봄
- 기타

리뷰 작성
URL: /bookings/[id]/review

레이아웃:
1. 서비스 정보 요약 (상단, 회색 배경)
   - 서비스 타입
   - 날짜
   - 매니저 이름 + 사진

2. 별점 선택 (필수)
   - 큰 별 아이콘 5개
   - 클릭 또는 드래그로 선택
   - 선택한 별점에 따라 텍스트 표시:
     * 1점: "별로예요"
     * 2점: "아쉬워요"
     * 3점: "보통이에요"
     * 4점: "좋아요!"
     * 5점: "최고예요!"

3. 리뷰 작성 (선택)
   - 텍스트 에리어 (최대 1000자)
   - 플레이스홀더:
     "매니저님의 서비스는 어떠셨나요?
     솔직한 리뷰는 다른 고객과 매니저에게 큰 도움이 됩니다."
   - 글자 수: "0/1000"

4. 안내 사항 (박스)
   "리뷰 작성 시 유의사항:
   - 작성 후 수정/삭제가 불가능합니다
   - 욕설이나 비방은 삭제될 수 있습니다
   - 서비스와 무관한 내용은 제외해주세요"

5. 하단 버튼
   - "취소" (secondary)
   - "리뷰 제출" (primary, 별점 선택 시만 활성화)

제출 후:
- "리뷰가 등록되었습니다!" 토스트
- /bookings로 리다이렉트
- 매니저에게 알림 발송
- 매니저 평점 자동 업데이트

카드 등록
URL: /payment/register-card

타이밍:
- 회원가입 후 (고객만)
- 첫 서비스 요청 전
- "결제 수단" 메뉴에서

레이아웃:
1. 안내 섹션
   - 아이콘: 🔒
   - 제목: "안전한 결제를 위해 카드를 등록해주세요"
   - 설명:
     "• 카드 정보는 토스페이먼츠에 안전하게 보관됩니다
     • 서비스 완료 후 24시간 뒤 자동으로 결제됩니다
     • 이의 신청 시 결제가 보류됩니다
     • 언제든지 카드를 변경할 수 있습니다"

2. 보안 배지
   - 토스페이먼츠 로고
   - "PCI-DSS 인증"
   - "SSL 보안"

3. "카드 등록하기" 버튼 (primary, 대형)
   - 클릭 시 토스페이먼츠 팝업 오픈

토스페이먼츠 팝업 플로우:
1. 카드 번호 입력 (16자리)
2. 유효기간 입력 (MM/YY)
3. CVC 입력 (3자리)
4. 생년월일 6자리 입력
5. 비밀번호 앞 2자리
6. SMS 인증번호 입력
7. 빌링키 발급 성공

성공 후:
- 팝업 닫힘
- 등록 완료 화면
  ┌─────────────────────────────────┐
  │ ✓ 카드 등록이 완료되었습니다!    │
  │                                 │
  │ 신한카드 **** **** **** 1234    │
  │                                 │
  │ 이제 서비스를 요청하실 수 있어요 │
  │                                 │
  │ [서비스 요청하러 가기]           │
  └─────────────────────────────────┘

실패 시:
- 에러 메시지 표시
- "다시 시도" 버튼

4.4 매니저 화면
매니저 프로필 작성/수정
URL: /manager/profile

접근: 
- 매니저 회원가입 직후 (필수)
- 헤더 프로필 드롭다운 → "프로필"

레이아웃:
1. 프로필 사진
   - 원형 이미지 (200x200px)
   - "사진 변경" 버튼
   - 클릭 시 파일 선택
   - 업로드 시 미리보기
   - 권장: "얼굴이 잘 보이는 증명사진 형태"

2. 자기소개 (필수)
   - 제목: "자기소개를 작성해주세요"
   - 텍스트 에리어 (최대 1000자)
   - 플레이스홀더:
     "예:
     안녕하세요, 10년차 간호조무사 출신 김**입니다.
     어르신과 환자분들을 정성껏 모시겠습니다.
     
     경력:
     - 요양병원 5년 근무
     - 가정 돌봄 서비스 3년
     
     강점:
     - 친절하고 꼼꼼한 케어
     - 응급 상황 대처 가능"
   - 글자 수: "0/1000"

3. 제공 가능 서비스 (필수, 최소 1개)
   - 제목: "어떤 서비스를 제공하시나요?"
   - 체크박스 (여러 개 선택 가능)
     ☐ 병원 동행
     ☐ 1시간 전용 동행
     ☐ 투석 전용 동행
     ☐ 노인 돌봄
     ☐ 아이 돌봄
     ☐ 기타 동행

4. 활동 가능 지역 (필수, 최소 1개)
   - 제목: "어느 지역에서 활동하시나요?"
   - 멀티 셀렉트 드롭다운
   - 검색 가능
   - 선택한 지역 태그로 표시
   - 예: 
     [서울 강남구 ×] [서울 서초구 ×] [+ 추가]
   
   지역 목록:
   - 서울 25개 구
   - 경기도 주요 시/구
   - (확장 가능)

5. 희망 시간당 요금 (선택)
   - 입력 필드 (숫자만)
   - 플레이스홀더: "20,000"
   - 단위: "원/시간"
   - 안내: "작성하지 않으면 플랫폼 기본 요금이 적용됩니다"

6. 활동 상태 (토글)
   - 제목: "활동 상태"
   - 스위치 버튼
     ON: "활동 중 - 새로운 요청 알림을 받습니다"
     OFF: "휴식 중 - 새로운 요청 알림을 받지 않습니다"
   - 기본값: ON

7. 하단 버튼
   - "취소" (secondary)
   - "저장" (primary)

저장 시:
- "프로필이 저장되었습니다!" 토스트
- 첫 작성 후: /manager/requests로 리다이렉트
- 수정 후: 현재 페이지 유지

검증:
- 사진: 선택 (권장하지만 필수 아님)
- 자기소개: 최소 50자
- 서비스: 최소 1개
- 지역: 최소 1개

새 요청 목록 (실시간)
URL: /manager/requests

목적: 
- 자신의 활동 지역 내 새 요청 실시간 확인
- 빠르게 지원하기

상단:
1. 필터
   - 서비스 타입 (전체, 병원동행, 노인돌봄 등)
   - 거리 (전체, 5km, 10km, 20km)
   
2. 정렬
   - 최신 순 (기본)
   - 가까운 순
   - 금액 높은 순

실시간 업데이트:
- Supabase Realtime 구독
- 새 요청이 들어오면 상단에 자동 추가
- "새 요청 N개" 배너 표시 (클릭 시 새로고침)

요청 카드:
┌─────────────────────────────────┐
│ 🏥 병원 동행                     │
│ 2024년 2월 1일 10:00 · 2시간    │
│                                 │
│ 📍 서울시 강남구 ... (1.2km)    │
│                                 │
│ "서울대병원 내과 진료 동행      │
│  부탁드립니다. 휠체어 필요..."  │
│                                 │
│ 예상 금액: 40,000원             │
│                                 │
│ 5분 전 · 지원자 2명             │
│                                 │
│ [상세보기] [지원하기]            │
└─────────────────────────────────┘

카드 상태:
- 신규: 파란색 테두리
- 지원 많음 (5명 이상): 경쟁 뱃지

이미 지원한 요청:
- 목록에서 숨김 또는
- "지원 완료" 뱃지 + 비활성화

"상세보기" 클릭 시 모달:
┌─────────────────────────────────┐
│         서비스 요청 상세          │
├─────────────────────────────────┤
│ 🏥 병원 동행                     │
│ 2024년 2월 1일 10:00            │
│ 예상 소요: 2시간                │
│                                 │
│ 위치:                           │
│ [지도]                          │
│ 서울시 강남구 ...               │
│ (내 위치에서 1.2km)             │
│                                 │
│ 상세 요청사항:                  │
│ "서울대병원 내과 진료 동행      │
│  부탁드립니다.                  │
│  - 휠체어 필요                  │
│  - 주차 가능                    │
│  - 진료 후 약 타러 가야 함"     │
│                                 │
│ 예상 금액: 40,000원             │
│                                 │
│ 현재 지원자: 2명                │
│                                 │
│ [지원하기] [닫기]                │
└─────────────────────────────────┘

"지원하기" 클릭 시 모달:
┌─────────────────────────────────┐
│       지원하기                   │
├─────────────────────────────────┤
│ 고객에게 보낼 메시지 (선택)      │
│ ┌─────────────────────────────┐ │
│ │ "안녕하세요,               │ │
│ │  해당 지역에서 5년간       │ │
│ │  활동한 매니저입니다.      │ │
│ │  성실하게 모시겠습니다!"   │ │
│ └─────────────────────────────┘ │
│ 0/500                           │
│                                 │
│ 안내:                           │
│ • 지원 후에는 취소할 수 없습니다│
│ • 고객이 선택하면 알림을 보내드려요│
│                                 │
│ [취소] [지원하기]                │
└─────────────────────────────────┘

지원 완료 후:
- "지원이 완료되었습니다!" 토스트
- 해당 카드 목록에서 제거
- "내 지원 현황"에 추가

빈 상태:
- 일러스트
- "현재 새로운 요청이 없습니다"
- "잠시 후 다시 확인해주세요"
- 자동 새로고침 (30초마다)

내 지원 현황
URL: /manager/applications

상단 탭:
- [대기 중] (PENDING)
- [확정됨] (ACCEPTED)
- [거절됨] (REJECTED)

─────────────────────────────────
탭 1: 대기 중
─────────────────────────────────

설명: "지원했지만 아직 고객이 선택하지 않은 요청입니다"

지원 카드:
┌─────────────────────────────────┐
│ 🏥 병원 동행                     │
│ 2024년 2월 1일 10:00            │
│                                 │
│ 서울시 강남구 ... (1.2km)       │
│                                 │
│ 지원 일시: 10분 전              │
│ 총 지원자: 3명                  │
│                                 │
│ 내 메시지:                      │
│ "안녕하세요, 성실하게..."       │
│                                 │
│ [상세보기]                      │
└─────────────────────────────────┘

상태 표시:
- 경쟁 낮음 (3명 이하): 초록색 뱃지
- 경쟁 보통 (4-6명): 노란색 뱃지
- 경쟁 높음 (7명 이상): 빨간색 뱃지

─────────────────────────────────
탭 2: 확정됨
─────────────────────────────────

설명: "고객이 선택한 서비스입니다"

자동으로 "내 일정"으로 이동하는 배너:
"확정된 예약은 '내 일정'에서 확인하세요 →"

확정 카드 (최근 3개만 표시):
┌─────────────────────────────────┐
│ ✓ 확정됨                         │
│                                 │
│ 🏥 병원 동행                     │
│ 2024년 2월 1일 10:00            │
│                                 │
│ 고객: 박** 님                   │
│                                 │
│ [상세보기] [일정 확인하기]       │
└─────────────────────────────────┘

─────────────────────────────────
탭 3: 거절됨
─────────────────────────────────

설명: "다른 매니저가 선택된 요청입니다"

거절 카드:
┌─────────────────────────────────┐
│ ✗ 다른 매니저가 선택되었습니다   │
│                                 │
│ 🏥 병원 동행                     │
│ 2024년 2월 1일 10:00            │
│                                 │
│ 거절 일시: 1시간 전             │
│ 총 지원자: 5명                  │
└─────────────────────────────────┘

안내 메시지:
"다음 기회에 선택될 수 있도록 프로필과 메시지를 잘 작성해보세요!"

내 일정 (확정된 예약)
URL: /manager/schedule

상단 탭:
- [달력 보기]
- [목록 보기] (기본)

─────────────────────────────────
목록 보기
─────────────────────────────────

날짜별 그룹화:
오늘 (강조)
└─ 예약 카드 1
└─ 예약 카드 2

내일
└─ 예약 카드 3

2024년 2월 3일
└─ 예약 카드 4

예약 카드:
┌─────────────────────────────────┐
│ 🏥 병원 동행                     │
│ 10:00 - 12:00 (2시간)           │
│                                 │
│ 고객: 박** 님                   │
│ 전화: 010-****-1234 (보기)      │
│                                 │
│ 위치: 서울시 강남구 ... (1.2km) │
│ [지도 보기]                     │
│                                 │
│ 상세 요청:                      │
│ "서울대병원 내과..."            │
│                                 │
│ 예상 금액: 40,000원             │
│                                 │
│ [서비스 시작] (당일만 표시)      │
│ 또는                            │
│ [고객에게 연락하기]              │
└─────────────────────────────────┘

당일 서비스 (특별 UI):
- 상단 고정
- 시작 전: "N시간 후 시작" 타이머
- 시작 가능 시점: "서비스 시작" 버튼 강조

"서비스 시작" 클릭 시 모달:
┌─────────────────────────────────┐
│     서비스를 시작하시겠습니까?   │
├─────────────────────────────────┤
│ 현재 시각: 2024.02.01 10:05    │
│                                 │
│ 안내:                           │
│ • 시작 시각이 기록됩니다        │
│ • 실제 소요 시간이 계산됩니다   │
│ • 정확한 시각에 눌러주세요      │
│                                 │
│ [취소] [시작하기]                │
└─────────────────────────────────┘

시작 후 상태:
┌─────────────────────────────────┐
│ ⏱️ 서비스 진행 중                │
│                                 │
│ 시작 시각: 10:05                │
│ 경과 시간: 00:15:30 (실시간)    │
│                                 │
│ [서비스 완료하기]                │
└─────────────────────────────────┘

"서비스 완료" 클릭 시 모달:
┌─────────────────────────────────┐
│     서비스를 완료하시겠습니까?   │
├─────────────────────────────────┤
│ 시작 시각: 10:05                │
│ 현재 시각: 12:23                │
│ 총 소요 시간: 2시간 18분        │
│                                 │
│ 최종 금액 계산:                 │
│ • 기본 요금: 20,000원/시간      │
│ • 2.3시간 × 20,000원            │
│ • = 46,000원                    │
│ • 주말 할증 +20%                │
│ • 최종: 55,200원                │
│                                 │
│ 안내:                           │
│ • 고객에게 최종 금액이 안내됩니다│
│ • 24시간 후 자동 결제됩니다     │
│ • 결제 완료 후 정산 대기로 전환됩니다│
│                                 │
│ [취소] [완료하기]                │
└─────────────────────────────────┘

완료 후:
- "서비스가 완료되었습니다!" 토스트
- 예약 상태 변경
- 고객에게 알림 발송
- "완료된 서비스" 목록으로 이동

─────────────────────────────────
달력 보기
─────────────────────────────────

월간 달력:
- 예약 있는 날짜: 파란색 점 표시
- 날짜 클릭 시 해당 날짜 예약 목록 표시
- 오늘 날짜 하이라이트

우측 패널:
- 선택한 날짜의 예약 목록
- 각 예약 간단 정보
- 클릭 시 상세 모달

수익 관리
URL: /manager/earnings

레이아웃:

1. 요약 카드 (상단, 3개 나란히)
   ┌─────────────┐
   │ 이번 달 수익 │
   │  450,000원  │
   │ ────────── │
   │ 전월 대비   │
   │ +15% ↑     │
   └─────────────┘
   
   ┌─────────────┐
   │ 정산 대기   │
   │  120,000원  │
   │ ────────── │
   │ 3건         │
   └─────────────┘
   
   ┌─────────────┐
   │ 총 누적 수익│
   │ 3,200,000원 │
   │ ────────── │
   │ 전체 기간   │
   └─────────────┘

2. 정산 신청 (정산 대기 금액 있을 시)
   ┌─────────────────────────────────┐
   │ 💰 정산 신청                     │
   ├─────────────────────────────────┤
   │ 정산 가능 금액: 120,000원       │
   │ (완료된 서비스 3건)             │
   │                                 │
   │ 계좌 정보:                      │
   │ 신한은행 110-123-456789         │
   │ 예금주: 김**                    │
   │ [계좌 변경]                     │
   │                                 │
   │ 정산 예정일: 다음 월요일        │
   │                                 │
   │ [정산 신청하기]                 │
   └─────────────────────────────────┘

3. 탭:
   - [서비스 내역] (기본)
   - [정산 내역]

─────────────────────────────────
탭 1: 서비스 내역
─────────────────────────────────

필터:
- 기간 (이번 달, 지난 달, 직접 선택)
- 상태 (전체, 정산 대기, 정산 완료)

서비스 카드:
┌─────────────────────────────────┐
│ 2024.01.25 10:00                │
│ 🏥 병원 동행                     │
│                                 │
│ 고객: 박** 님                   │
│ 소요 시간: 2시간 18분           │
│                                 │
│ 결제 금액: 46,000원             │
│ 플랫폼 수수료: 9,200원 (20%)    │
│ 내 수익: 36,800원               │
│                                 │
│ 상태: ⏳ 정산 대기              │
│ 또는                            │
│ 상태: ✓ 정산 완료 (01.29)      │
└─────────────────────────────────┘

통계 (하단):
- 이번 달 총 서비스: 15건
- 평균 서비스 시간: 2시간 30분
- 평균 수익: 30,000원/건

─────────────────────────────────
탭 2: 정산 내역
─────────────────────────────────

정산 카드:
┌─────────────────────────────────┐
│ 2024년 1월 4주차 정산           │
│                                 │
│ 정산 금액: 450,000원            │
│ (서비스 15건)                   │
│                                 │
│ 입금 계좌: 신한은행 110-***-*789│
│ 입금 일시: 2024.01.29 14:30    │
│                                 │
│ 상태: ✓ 완료                    │
│                                 │
│ [상세 내역 보기]                 │
└─────────────────────────────────┘

상세 내역 모달:
- 기간 내 모든 서비스 목록
- 각 서비스별 수익
- 합계

4.5 관리자 화면 (최소 구현)
관리자 대시보드
URL: /admin

접근 권한: role === 'ADMIN'만

레이아웃:

1. 통계 카드 (4개)
   ┌─────────────┐ ┌─────────────┐
   │ 총 사용자   │ │ 총 매니저   │
   │    500명    │ │    200명    │
   └─────────────┘ └─────────────┘
   
   ┌─────────────┐ ┌─────────────┐
   │ 이번 달 매칭│ │ 이번 달 거래액│
   │    300건    │ │ 15,000,000원│
   └─────────────┘ └─────────────┘

2. 그래프 (선택적)
   - 일별 매칭 건수 (라인 차트)
   - 서비스 타입별 비율 (파이 차트)

3. 최근 요청 목록
   - 상태별 필터
   - 간단한 정보 표시
   - 클릭 시 상세 페이지

4. 최근 가입 회원
   - 역할별 필터
   - 승인 대기 매니저 있으면 강조 (선택적)

5. 정산 관리 (간단히)
   - 정산 신청 목록
   - "완료 처리" 버튼
   - 수동 처리 기록

최소 기능:
- 데이터 조회 (읽기 전용)
- 통계 확인
- 정산 완료 처리

향후 확장:
- 회원 관리 (정지, 탈퇴)
- 신고 처리
- 환불 처리
- 고객 지원 메시지

5. 알림 시스템 설계
5.1 알림 발송 시점 및 내용
─────────────────────────────────
고객 알림
─────────────────────────────────

1. NEW_APPLICATION
시점: 매니저가 지원 제출 시
제목: "새로운 지원자가 있습니다"
내용: "김** 님이 '{서비스명}' 요청에 지원했습니다. 지금 확인해보세요!"
액션: 클릭 시 /requests/[id]로 이동
데이터: { request_id: 'xxx', manager_name: '김**' }

2. BOOKING_CONFIRMED
시점: 매니저 선택 완료 시
제목: "예약이 확정되었습니다!"
내용: "김** 님과의 서비스가 확정되었습니다. 2024.02.01 10:00에 만나요!"
액션: /bookings/[id]

3. SERVICE_STARTING_SOON
시점: 서비스 시작 1시간 전
제목: "서비스 시작 1시간 전입니다"
내용: "오늘 10:00 '{서비스명}' 서비스가 시작됩니다. 준비해주세요!"
액션: /bookings/[id]

4. SERVICE_COMPLETED
시점: 매니저가 서비스 완료 버튼 클릭 시
제목: "서비스가 완료되었습니다"
내용: "최종 금액: 46,000원. 24시간 후 자동 결제됩니다."
액션: /bookings/[id]

5. PAYMENT_COMPLETED
시점: 자동 결제 완료 시
제목: "결제가 완료되었습니다"
내용: "46,000원이 결제되었습니다. 영수증을 확인해주세요."
액션: /payments/[id]
추가: 영수증 이메일 발송

6. REVIEW_REMINDER
시점: 결제 완료 후 리뷰 미작성 시 (3일 후)
제목: "서비스는 어떠셨나요?"
내용: "리뷰를 남기고 다른 고객을 도와주세요!"
액션: /bookings/[id]/review

─────────────────────────────────
매니저 알림
─────────────────────────────────

1. NEW_REQUEST_NEARBY
시점: 활동 지역 내 새 요청 생성 시
제목: "근처에 새로운 요청이 있습니다!"
내용: "서울 강남구 '병원 동행' 요청 (1.2km) - 40,000원"
액션: /manager/requests
데이터: { request_id: 'xxx', distance: '1.2km' }
조건: 
- manager_profiles.is_active = true
- service_areas에 요청 지역 포함
- available_services에 요청 서비스 타입 포함
- 거리 10km 이내

2. APPLICATION_ACCEPTED
시점: 고객이 해당 매니저 선택 시
제목: "축하합니다! 선택되었습니다 🎉"
내용: "박** 님이 회원님을 선택했습니다. 2024.02.01 10:00 서비스 준비해주세요!"
액션: /manager/schedule

3. APPLICATION_REJECTED
시점: 고객이 다른 매니저 선택 시
제목: "다른 매니저가 선택되었습니다"
내용: "아쉽지만 다음 기회에 선택될 수 있도록 노력해주세요!"
액션: /manager/applications

4. SERVICE_STARTING_SOON
시점: 서비스 시작 1시간 전
제목: "서비스 시작 1시간 전입니다"
내용: "오늘 10:00 박** 님과의 서비스가 시작됩니다."
액션: /manager/schedule

5. NEW_REVIEW
시점: 고객이 리뷰 작성 시
제목: "새로운 리뷰가 등록되었습니다"
내용: "⭐⭐⭐⭐⭐ 박** 님이 리뷰를 남겼습니다. 확인해보세요!"
액션: /manager/earnings (또는 리뷰 페이지)

6. SETTLEMENT_COMPLETED
시점: 정산 완료 처리 시
제목: "정산이 완료되었습니다 💰"
내용: "450,000원이 입금되었습니다. 계좌를 확인해주세요!"
액션: /manager/earnings

5.2 푸시 알림 구현 방법
기술: Firebase Cloud Messaging (FCM)

─────────────────────────────────
1. 초기 설정
─────────────────────────────────

사용자 로그인 시:
1. FCM 토큰 요청
2. 토큰 받기
3. users 테이블에 fcm_token 컬럼 추가 및 저장
4. 토큰 만료 시 자동 갱신

웹:
- Service Worker 등록
- 푸시 알림 권한 요청
- 브라우저에서 알림 수신

─────────────────────────────────
2. 알림 발송 프로세스
─────────────────────────────────

예: 매니저가 지원 시

1. 백엔드에서 이벤트 감지
   - POST /api/applications
   - 지원 데이터 저장 완료

2. notifications 테이블에 기록
   INSERT INTO notifications (
     user_id,
     type,
     title,
     message,
     data,
     is_read
   ) VALUES (
     customer_id,
     'NEW_APPLICATION',
     '새로운 지원자가 있습니다',
     '김** 님이 지원했습니다',
     jsonb '{"request_id": "xxx"}',
     false
   )

3. FCM API 호출
   - 고객의 fcm_token 조회
   - FCM 서버에 푸시 요청
   POST https://fcm.googleapis.com/v1/projects/PROJECT_ID/messages:send
   {
     "message": {
       "token": "user_fcm_token",
       "notification": {
         "title": "새로운 지원자가 있습니다",
         "body": "김** 님이 지원했습니다"
       },
       "data": {
         "type": "NEW_APPLICATION",
         "request_id": "xxx",
         "click_action": "/requests/xxx"
       }
     }
   }

4. 사용자 기기에서 알림 수신
   - Service Worker가 알림 표시
   - 클릭 시 click_action URL로 이동

─────────────────────────────────
3. 알림 읽음 처리
─────────────────────────────────

사용자가 알림 클릭 또는 페이지 접속 시:
PUT /api/notifications/[id]/read
{
  is_read: true
}

또는 일괄 읽음:
PUT /api/notifications/read-all

─────────────────────────────────
4. 알림 자동 삭제
─────────────────────────────────

Supabase Cron Job (매일 새벽 3시):
DELETE FROM notifications
WHERE is_read = true
AND created_at < NOW() - INTERVAL '30 days'

5.3 알림 권한 요청 UX
시점: 로그인 후 첫 방문 시

모달 또는 배너:
┌─────────────────────────────────┐
│ 🔔 알림 받기                     │
├─────────────────────────────